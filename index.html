<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prism Insight - AI Report</title>
    <style>
        :root {
            --bg-color: #0b0e14;
            --card-bg: #161b22;
            --text-main: #ffffff;
            --text-sub: #8b949e;
            --accent-hot: #f85149;
            --accent-cool: #58a6ff;
            --border-color: #30363d;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color); color: var(--text-main);
            margin: 0; padding: 15px; line-height: 1.5;
        }

        .container { max-width: 480px; margin: 0 auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        .logo { font-size: 20px; font-weight: 800; color: #58a6ff; }
        .date { font-size: 11px; color: var(--text-sub); }

        .section-title { font-size: 16px; font-weight: 700; margin: 25px 0 12px 0; color: #c9d1d9; border-left: 4px solid #58a6ff; padding-left: 10px; }

        /* Market Cards */
        .market-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .market-card { background: var(--card-bg); padding: 12px; border-radius: 12px; border: 1px solid var(--border-color); }
        .m-name { font-size: 11px; color: var(--text-sub); }
        .m-price { font-size: 16px; font-weight: 700; }
        .up { color: var(--accent-hot); } .down { color: var(--accent-cool); }

        /* Sectors & News */
        .sectors-container, .news-list { display: flex; flex-direction: column; gap: 10px; }
        .sector-card, .news-item { background: var(--card-bg); padding: 12px; border-radius: 10px; border: 1px solid var(--border-color); }
        .sector-card.HOT { border-left: 4px solid var(--accent-hot); }
        .sector-card.COOL { border-left: 4px solid var(--accent-cool); }
        
        .news-item { text-decoration: none; color: inherit; font-size: 13px; display: block; }
        .news-title { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; display: block; }

        /* Summary & Picks */
        .summary-box { background: rgba(88, 166, 255, 0.05); padding: 15px; border-radius: 12px; border: 1px dashed #30363d; font-size: 13.5px; }
        .pick-list { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .pick-item { background: #21262d; padding: 10px; border-radius: 8px; text-align: center; border: 1px solid #30363d; font-size: 12px; font-weight: 600; }

        /* Hit Rate */
        .hit-rate-box { text-align: center; padding: 20px; background: var(--card-bg); border-radius: 15px; margin-bottom: 30px; border: 1px solid var(--border-color); }
        .hit-value { font-size: 36px; font-weight: 900; color: var(--accent-hot); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">PRISM INSIGHT ğŸ’</div>
            <div id="report-date" class="date">Loading...</div>
        </header>

        <div id="market-indices" class="market-grid"></div>

        <div class="section-title">ì‹œì¥ ìš”ì•½</div>
        <div id="summary" class="summary-box"></div>

        <div class="section-title">ì£¼ìš” ì„¹í„° í˜„í™©</div>
        <div id="sectors-list" class="sectors-container"></div>

        <div class="section-title">ê¸€ë¡œë²Œ ì£¼ìš” ë‰´ìŠ¤</div>
        <div id="news-list" class="news-list"></div>

        <div class="section-title">ì˜¤ëŠ˜ì˜ AI ì¶”ì²œ ì¢…ëª©</div>
        <div id="picks-list" class="pick-list"></div>

        <div class="section-title">ì „ì¼ ì¶”ì²œ ìˆ˜ìµë¥ </div>
        <div id="past-results" class="pick-list"></div>

        <div class="section-title">ëˆ„ì  ìƒìŠ¹ ì ì¤‘ë¥ </div>
        <div class="hit-rate-box">
            <div id="hit-rate-value" class="hit-value">0%</div>
            <div style="font-size: 11px; color: var(--text-sub);">ìµœê·¼ 30ì¼ ë°ì´í„° ë¶„ì„ ê¸°ì¤€</div>
        </div>
    </div>

    <script>
        async function updateUI() {
            try {
                const [res, hRes] = await Promise.all([fetch('recommendations.json'), fetch('history.json')]);
                const data = await res.json();
                const history = await hRes.json();

                document.getElementById('report-date').innerText = data.date;
                document.getElementById('summary').innerText = data.summary;

                // ì§€ìˆ˜ ë Œë”ë§
                document.getElementById('market-indices').innerHTML = Object.entries(data.market_info).map(([k, v]) => `
                    <div class="market-card">
                        <div class="m-name">${v.status} ${k}</div>
                        <div class="m-price">${v.price.toLocaleString()}</div>
                        <div class="m-change ${v.change >= 0 ? 'up' : 'down'}">${v.change >= 0 ? 'â–²' : 'â–¼'} ${Math.abs(v.change)}%</div>
                    </div>
                `).join('');

                // ì„¹í„° ë Œë”ë§
                document.getElementById('sectors-list').innerHTML = data.sectors.map(s => `
                    <div class="sector-card ${s.sentiment}">
                        <div style="display:flex; justify-content:space-between; font-size:13px; font-weight:bold; margin-bottom:5px;">
                            <span>${s.name}</span><span style="color:${s.sentiment==='HOT'?'#f85149':'#58a6ff'}">${s.sentiment}</span>
                        </div>
                        <div style="font-size:11px; color:#8b949e;">${s.reason}</div>
                    </div>
                `).join('');

                // ë‰´ìŠ¤ ë Œë”ë§ (ë³µêµ¬!)
                document.getElementById('news-list').innerHTML = data.news_headlines.map(n => `
                    <a href="${n.link}" class="news-item" target="_blank">
                        <span class="news-title">ğŸ“° ${n.title}</span>
                    </a>
                `).join('');

                // ì¢…ëª© ë° ê³¼ê±° ìˆ˜ìµë¥ 
                document.getElementById('picks-list').innerHTML = data.tickers.map(t => `<div class="pick-item">${t}</div>`).join('');
                document.getElementById('past-results').innerHTML = data.past_results.map(r => `
                    <div class="pick-item">
                        <div>${r.ticker}</div>
                        <div class="${r.change >= 0 ? 'up' : 'down'}" style="font-size:10px;">${r.change}%</div>
                    </div>
                `).join('');

                // ì ì¤‘ë¥  ê³„ì‚°
                let total = 0, hits = 0;
                history.forEach(day => day.performance.forEach(p => { total++; if(p.change > 0) hits++; }));
                document.getElementById('hit-rate-value').innerText = (total > 0 ? (hits/total*100).toFixed(1) : 0) + "%";

            } catch (err) { console.error(err); }
        }
        updateUI();
    </script>
    
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['treemap']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Location', 'Parent', 'Market Trade Volume (size)'],
          ['Global Market', null, 0],
          // AIê°€ ìƒì„±í•œ keywords ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì  ìƒì„±
          ['AIë°˜ë„ì²´', 'Global Market', 25],
          ['ê¸ˆë¦¬ë™ê²°', 'Global Market', 20],
          ['ì—”ë¹„ë””ì•„', 'Global Market', 15]
        ]);

        var tree = new google.visualization.TreeMap(document.getElementById('chart_div'));
        tree.draw(data, {
          minColor: '#f00', midColor: '#ddd', maxColor: '#0d0',
          headerHeight: 15, fontColor: 'black', showScale: true
        });
      }
    </script>

<div id="chart_div" style="width: 100%; height: 300px;"></div>
</body>
</html>
