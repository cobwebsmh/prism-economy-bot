<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prism Insight Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-5">
    <div class="max-w-4xl mx-auto">
        <header class="mb-10 text-center">
            <h1 class="text-4xl font-bold text-blue-400 mb-2">ğŸ’ Prism Insight</h1>
            <p id="update-time" class="text-gray-400">ë°ì´í„° ë™ê¸°í™” ì¤‘...</p>
        </header>

        <div id="indices-container" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-10">
            <div class="bg-gray-800 p-4 rounded-lg text-center animate-pulse">ì§€ìˆ˜ ë¡œë”© ì¤‘...</div>
            <div class="bg-gray-800 p-4 rounded-lg text-center animate-pulse">ì§€ìˆ˜ ë¡œë”© ì¤‘...</div>
        </div>

        <section class="bg-gray-800 p-6 rounded-xl mb-10 shadow-lg border-l-4 border-blue-500">
            <h2 class="text-xl font-semibold mb-4 text-blue-300">ì˜¤ëŠ˜ì˜ ì‹œì¥ ìš”ì•½</h2>
            <p id="market-summary" class="text-lg leading-relaxed text-gray-200 font-medium">
                ë¶„ì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...
            </p>
        </section>

        <section class="mb-10">
            <h2 class="text-xl font-semibold mb-4 text-blue-300">AI ì¶”ì²œ í‹°ì»¤</h2>
            <div id="ticker-container" class="flex flex-wrap gap-3">
                </div>
        </section>

        <div id="error-log" class="hidden mt-10 p-4 bg-red-900/30 border border-red-500/50 rounded-lg text-red-200 text-sm">
        </div>
    </div>

    <script>
        async function loadData() {
            const errorLog = document.getElementById('error-log');
            const summaryEl = document.getElementById('market-summary');

            try {
                // ìºì‹œ ë°©ì§€ë¥¼ ìœ„í•´ íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€
                const response = await fetch('recommendations.json?t=' + Date.now());
                
                if (!response.ok) {
                    throw new Error(`íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (Status: ${response.status})`);
                }
                
                const data = await response.json();
                console.log("Loaded Data:", data);

                // 1. ì—…ë°ì´íŠ¸ ì‹œê°„
                document.getElementById('update-time').innerText = `ìµœê·¼ ì—…ë°ì´íŠ¸: ${data.date || 'ì•Œ ìˆ˜ ì—†ìŒ'}`;

                // 2. ì§€ìˆ˜ ë Œë”ë§ (ë°ì´í„°ê°€ ì—†ì„ ê²½ìš° ë°©ì–´)
                const indicesContainer = document.getElementById('indices-container');
                if (data.indices && Array.isArray(data.indices) && data.indices.length > 0) {
                    indicesContainer.innerHTML = data.indices.map(item => `
                        <div class="bg-gray-800 p-4 rounded-lg text-center border border-gray-700">
                            <div class="text-xs text-gray-400 uppercase tracking-wider">${item.name}</div>
                            <div class="text-xl font-bold mt-1 ${item.change >= 0 ? 'text-red-400' : 'text-blue-400'}">
                                ${item.change >= 0 ? 'â–²' : 'â–¼'} ${Math.abs(item.change)}%
                            </div>
                        </div>
                    `).join('');
                } else {
                    indicesContainer.innerHTML = '<p class="text-gray-500 col-span-4 text-center">ì§€ìˆ˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                }

                // 3. ì‹œì¥ ìš”ì•½ ë Œë”ë§
                summaryEl.innerText = data.summary || "ë¶„ì„ ìš”ì•½ ë‚´ìš©ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.";

                // 4. í‹°ì»¤ ë Œë”ë§
                const tickerContainer = document.getElementById('ticker-container');
                if (data.tickers && Array.isArray(data.tickers) && data.tickers.length > 0) {
                    tickerContainer.innerHTML = data.tickers.map(ticker => `
                        <span class="bg-blue-600/20 text-blue-300 px-5 py-2 rounded-full font-bold border border-blue-500/30 hover:bg-blue-600/40 transition-all cursor-default">
                            ${ticker}
                        </span>
                    `).join('');
                } else {
                    tickerContainer.innerHTML = '<p class="text-gray-500 font-italic">í˜„ì¬ ì¶”ì²œëœ í‹°ì»¤ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                }

            } catch (error) {
                console.error('Display Error:', error);
                summaryEl.classList.add('text-red-400');
                summaryEl.innerText = "ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                
                errorLog.classList.remove('hidden');
                errorLog.innerHTML = `
                    <strong>âš ï¸ ëŒ€ì‹œë³´ë“œ ì˜¤ë¥˜ ì•Œë¦¼:</strong><br>
                    - ì›ì¸: ${error.message}<br>
                    - ì¡°ì¹˜: GitHub Actionsì˜ 'Workflow permissions'ê°€ 'Read and write'ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
                `;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ í›„ ì‹¤í–‰
        window.onload = loadData;
    </script>
</body>
</html>
